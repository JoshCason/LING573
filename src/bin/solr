#!/bin/sh -e
# Meant to be placed in /etc/init.d/
# Then one can do update-rc.d solr defaults to have it start at boot.
# Starts, stops, and restarts solr

# Get path of this bash script ... assumes in src/bin directory
SOLR_DIR="`dirname \"$0\"`/../apache-solr-3.6.2/573"
JAVA_OPTIONS="-Xmx1024m -Djetty.port=8983 -Dsolr.solr.home=multicore -DSTOP.PORT=8079 -DSTOP.KEY=stopkey -jar start.jar"
LOG_FILE="/var/log/solr.log"
JAVA="/usr/bin/java"

case $1 in
    start)
        echo "Starting Solr"
        cd $SOLR_DIR
        $JAVA $JAVA_OPTIONS 2> $LOG_FILE &
        ;;
    stop)
        echo "Stopping Solr"
        cd $SOLR_DIR
        $JAVA $JAVA_OPTIONS --stop
        ;;
    restart)
        $0 stop
        sleep 1
        $0 start
        ;;
    *)
        echo "Usage: $0 {start|stop|restart}" >&2
        exit 1
        ;;
esac

